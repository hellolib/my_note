# 网编&并发串讲

```python
算法 底层 数据结构 平台(mysql平台,redis平台) 网络 安全 相关知识
```

## 网络编程

1. 基于tcp的socket server client(手写)

2. 基于tcp的socket server client(手写)

3. socketserver 启动web服务的server端(手写)

4. 网络通信原理

   - 局域网/广域网的概念区别
   - 小局域网内部的通信:通过交换机,路由器(有交换机的功能)完成
     - 交换机基于mac地址进行通信
     - arp协议:地址解析协议,通过ip地址获取mac 交换机(广播,单播)
     - 交换机工作方式:广播,单播,组播

   - 局域网与局域网之间通信:路由器,三层交换机
     - 找到你要寻找的机器所在的网段
     - 网关:在同一个局域网的机器的同意出口ip

5. 内网/公网:

   - 内网ip:
     - 192.168.0.0-192.168.255.255                                                                                                        
     - 172.16.0.0-172.31.255.255
     - 10.0.0.0-10.255.255.255
   - 公网ip:0.0.0.0-255.255.255.255中除内网ip之外的所有网段

   - 端口:确认一台物理设备上的唯一一个服务的,0-65535

6. 协议

   - osi五层协议
   - 课下了解更多的协议
   - tcp协议/udp协议(传输层及以上所有协议是基于什么协议的)

   ​                                                      

7. dns 解析:通过通过域名解析找到对应机器的ip地址

8. cdn 内容分发网络.帮助用户加速访问,降低server端请求压力

   ```
   域名 方便记忆
   ip 快速找到机器
   mac 确认唯一机器
   ```

   

## 并发

1. 操作系统原理
   - 发展历程
   - IO操作

2. 进程
3. 线程:
4. 协程

5. ipc
6. 锁

```python
1.什么是进程线程协程
2.
3.Gil锁:
4.哪个地方用过进程:
5.哪些地方用过线程:django框架,flask框架,爬虫
6.哪些地方用过协程:flask框架, sanic框架,爬虫
7.为什么要用爬虫? 项目需求,朋友需要,自己需要,公司需要
8.C10k  C10M
	- C10K- connection 10 * 1000 = 10000连接(通过线程20个+协程解决500个)
    - C10M- connection 10 * 1000 * 1000 千万级连接(nginx负载均衡,haproxy负载均衡)
9.xxx是不是线程安全的
	列表.字典pop extend append 线程安全
    列表[0] += 1 字典[key] += 1是不安全的
10.logging 模块是不是线程安全的:是安全的,内部加锁了
```

## IO多路复用

- IO模型

  1. 阻塞IO模型 (recv,accept 阻塞)
  2. 非阻塞IO模型 (recv,accept 非阻塞)sk.setblocking(False) 设置为不阻塞
  3. IO多路复用
  4. 异步IO模型

- IO多路复用

  

  - 操作系统提供的,为了提高网络操作的并发效果,并且减少CPU的使用率才被推出的一个工具
    - select  机制(window只支持这一种,linux都支持)
    - poll  机制
    - epoll  机制

- select 机制是怎么实现的?

  - 操作系统会帮助程序对需要监听的对象进行轮询一旦有数据过来,就会把对应的对象返回

  - select
    - 轮询的机制
    - 由于底层数据结构的问题,select能够代理的网络对象是有限的
    - 随着监听的对象增多,效率也会降低

  - poll 机制
    - 轮询机制:
    - 对底层数据结构进行了优化,能够代理的对象没有限制了
    - 随着监听的对象增多,效率也会降低
  - epoll 机制
    - 不在采用轮询的机制,使用回调机制
    - 无论监听多少个网络对象,效率都是一样的

- 什么叫IO多路复用:

  - **操作系统提供的网络监听的代理**
  - 多个网络对象同时通用同一个代理,实现监听,就不需要再开启线程单独监听

## 数据库

1. 项目的表结构,数据量,数据库版本,QPS
   - 公司由多少台服务器,有哪些业务;
   - 有多少数据库,哪些数据库,数据库版本,你维护了多少数据库;
   - 公司有没有数据库平台:关系型,非关系型,谁来维护数据库;
   - 项目上线多长时间了? 数据量,qps;
   - 项目表中是否用到了索引,为什么要用;
   - 表结构(表结构设计都是项目经理或者架构师),表与表之间的关联,多少表,哪些业务,哪些表
   - 常用的sql;
2. 设计表结构
   - 建立约束和关联
   - 查询sql的角度

3. 给你现成的表结构
   - sql的查询
   - select语句(**分组聚合**),单表查和多表查

4. 数据库优化:

   - 架构建表层级优化 : 

     - **分库分表 , 读写分离 ** 

       - select读数据的速度慢,读的频繁,数据量大
       - 分库分表:垂直分表,水平分表

       ![1568280896914](C:\Users\big cattle\AppData\Roaming\Typora\typora-user-images\1568280896914.png)

     - 建立索引

     - 把固定的字段放前面,尽量多使用定长字段

   - sql语句优化 : 

     - 尽量在where阶段缩小范围
     - 多表查尽量使用连表查询代替子查询
     - **命中索引**

5. 数据库细节

   - char和warchar的区别

   - 搜索的时候创建一个唯一索引和创建普通索引的区别

     

```python
1.关系型数据库/非关系型数据库
- Mysql
2.存储引擎:innodb 外键;支持事务;行级锁;
3.库的操作;
	- 创建库
    - 使用库
    - 查看库
    - 查看库中由哪些表
4.表的操作
	- 查看有哪些表 show tables
    - 创建表 : create table
    - 查看表结构 : desc 表明/  show create table 表名;
    - 修改表 alter table 表名
5.数据的操作;
	- 增/删/改/查
    - 分组聚合
    - 联表查询
    - 子查询
6.索引
	- 创建索引
    - 删除索引
    - 命中索引
	- 覆盖索引和索引合并
7.pymysql模块
```

