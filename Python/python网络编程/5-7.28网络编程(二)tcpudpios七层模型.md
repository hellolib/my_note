# 5-7.28网络编程(二)tcp/udp

## 1.协议

### 1.1 TCP协议

- 可靠,速度慢,全双工通信

- 建立连接**三次握手**,断开连接**四次挥手**

- 建立起链接之后,发送每条消息都有回执,为了保证数据的完整性,还有重传机制

- 数据传输:有收必有发,收发必相等

- 长连接:会一直占用对方端口

- IO操作(input/output),IO操作的输入输出时相对内存来说
  - write-send (输出ouput)
  - read-recv (输入input)
  
  ```python
  #三次握手
  TCP是因特网中的传输层协议，使用三次握手协议建立连接。当主动方发出SYN连接请求后，等待对方回答SYN+ACK[1]，并最终对对方的 SYN 执行 ACK 确认。这种建立连接的方法可以防止产生错误的连接。[1] 
  TCP三次握手的过程如下：
  客户端发送SYN（SEQ=x）报文给服务器端，进入SYN_SEND状态。
  服务器端收到SYN报文，回应一个SYN （SEQ=y）ACK(ACK=x+1）报文，进入SYN_RECV状态。
  客户端收到服务器端的SYN报文，回应一个ACK(ACK=y+1）报文，进入Established状态。
  三次握手完成，TCP客户端和服务器端成功地建立连接，可以开始传输数据了。
                          
  #四次挥手
  (1) 某个应用进程首先调用close，称该端执行“主动关闭”（active close）。该端的TCP于是发送一个FIN分节，表示数据发送完毕。
  (2) 接收到这个FIN的对端执行 “被动关闭”（passive close），这个FIN由TCP确认。
  注意：FIN的接收也作为一个文件结束符（end-of-file）传递给接收端应用进程，放在已排队等候该应用进程接收的任何其他数据之后，因为，FIN的接收意味着接收端应用进程在相应连接上再无额外数据可接收。
  (3) 一段时间后，接收到这个文件结束符的应用进程将调用close关闭它的套接字。这导致它的TCP也发送一个FIN。
  (4) 接收这个最终FIN的原发送端TCP（即执行主动关闭的那一端）确认这个FIN。[1] 
  既然每个方向都需要一个FIN和一个ACK，因此通常需要4个分节。
  ```
  

![image-20211014215735168](https://raw.githubusercontent.com/hellolib/pictures/main/Typora/pic-00-gitee/image-20211014215735168.png)

### 1.2 UDP协议

- 不需要建立连接,速度特别快,可能会丢消息.

### 小结(TCP/UDP重点)

- 应用场景
  - TCP:文件上传下载(邮件,网盘)
  - UDP:即时通讯(微信,qq)

- 传输文件长度:
  - TCP 长度无限
  - UDP 能够传输的数据航都是有限的,根据数据传递设备的设置有关系

## 2.osi七层模型

- '应表会传网数物'

  ```也叫osi五层模型,专业七层,开发人员掌握五层模型,表示层会话层了解```

  - **应用层**:python代码
  - 表示层
  - 会话层
  - **传输层**:tcp协议 udp协议 端口
  - **网络层**:ipv4/ipv6协议
  - **数据链路层**:mac地址 arp协议
  - **物理层**:

![image-20211024173424898](https://raw.githubusercontent.com/hellolib/pictures/main/Typora/pic-00-gitee/image-20211024173424898.png)

### 每层运行常见协议/物理设备

| tcp/ip五层  | 每层运行常见协议                | 每层运行常见物理设备   |
| ----------- | ------------------------------- | ---------------------- |
| 5应用层     | python代码/http/https/ftp/smtp/ |                        |
| 4传输层     | tcp/udp协议 端口                | 四层交换机/四层路由器  |
| 3网络层     | ipv4/ipv6协议                   | 三层路由器/三层交换机  |
| 2数据链路层 | mac地址/arp协议                 | 网卡/交换机/二层交换机 |
| 1物理层     |                                 |                        |

## 3.socket

- 中文名字:套接字

- **Socket是应用层与传输层中间的抽象层，Socket帮助去组织拼接信息数据，以符合指定的协议。**

- socket对于程序员来说,已经是网络操作的底层了                                     

  ![image-20211024173450199](https://raw.githubusercontent.com/hellolib/pictures/main/Typora/pic-00-gitee/image-20211024173450199.png)

